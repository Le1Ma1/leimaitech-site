<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <title>LeiMai Pro è¨‚é–±</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- å‹•æ…‹åˆ‡æ› CSS è·¯å¾‘ï¼šä¸»ç«™èµ° /crypto-linebot/ï¼Œå¾Œç«¯(Render/æœ¬æ©Ÿ)èµ° /css/ -->
  <link id="theme-css" rel="stylesheet" href="">
  <script>
    (function() {
      var isMainSite = location.hostname.endsWith('leimaitech.com');
      var href = isMainSite ? '/crypto-linebot/css/style.css' : '/css/style.css';
      document.getElementById('theme-css').setAttribute('href', href);
    })();
  </script>
  <noscript>
    <!-- è‹¥åœç”¨ JSï¼Œé è¨­èµ°å¾Œç«¯ç‰ˆï¼›ä¸»ç«™è«‹æ‰‹å‹•æ”¹æˆ /crypto-linebot/css/style.css -->
    <link rel="stylesheet" href="/css/style.css">
  </noscript>

  <style>
    /* æ¥µç°¡ä¿åº•æ¨£å¼ï¼Œé¿å…è¼‰ä¸åˆ° CSS å®Œå…¨ç´ é¡ï¼ˆå¯ä»¥ä¿ç•™ä¹Ÿå¯åˆªï¼‰ */
    body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans TC",Arial,sans-serif;margin:0;padding:24px;background:#050510;color:#f5f5fa}
    .container{max-width:720px;margin:0 auto}
    .plan{background:#0f1126;border-radius:12px;padding:16px 20px;margin:18px 0;box-shadow:0 4px 12px rgba(0,0,0,.35);position: relative; overflow: visible;}
    .badge{display: inline-flex;background:#5a5aff;color:#fff; padding: .35rem .7rem; border-radius:999px;font-size:.85rem;margin-bottom:.5rem; align-items: center; line-height: 1}
    .price{font-weight:700}
    button{border:0;border-radius:999px;padding:.6rem 1rem}
    .badge-success { background:#16a34a; }

    /* crypto-linebot/index.html è£¡ Pro å¡å·¦ä¸Šå¾½ç« ä¹Ÿä¿éšªä¸€ä¸‹ */
    .pricing-card.pro{ position: relative; overflow: visible; padding-top: 32px; }
    .pricing-card.pro .badge-free{ position: absolute; top: 12px; left: 12px; }

    /* è¡Œå‹•è£ç½®å¾®èª¿ */
    @media (max-width:640px){
      .pricing-card.pro .badge-free{ top:10px; left:10px; }
    }
  </style>
</head>
<body>
  <main class="container">
    <h1>LeiMai Pro è¨‚é–±</h1>

    <section class="plan">
      <h2>Proï¼ˆæœˆç¹³ï¼‰</h2>
      <div class="badge badge-success">ğŸ‰ å‰ 10 æ—¥å…è²»</div>
      <p>ç¬¬ 11 å¤©èµ·æ¯æœˆè‡ªå‹•æ‰£æ¬¾ï¼Œæ‰£æ¬¾æ—¥ä¾ä½ çš„ç”³è¾¦æ—¥è€Œå®šã€‚</p>
      <p class="price">NT$199 / æœˆ</p>
      <button id="btnMonth">ç«‹å³è¨‚é–±ï¼ˆæœˆç¹³ï¼‰</button>
    </section>

    <section class="plan">
      <h2>Proï¼ˆå¹´ç¹³ï¼‰</h2>
      <div class="badge badge-success">ğŸ‰ å‰ 10 æ—¥å…è²»</div>
      <p>ç¬¬ 11 å¤©èµ·æ¯å¹´è‡ªå‹•æ‰£æ¬¾ï¼Œæ‰£æ¬¾æ—¥ä¾ä½ çš„ç”³è¾¦æ—¥è€Œå®šã€‚</p>
      <p class="price">NT$1,999 / å¹´</p>
      <button id="btnYear">ç«‹å³è¨‚é–±ï¼ˆå¹´ç¹³ï¼‰</button>
    </section>

    <p class="note">èªªæ˜ï¼šå‰ 10 æ—¥å…è²»ç‚ºæ•¸ä½å…§å®¹è©¦ç”¨ï¼Œé¦–æ‰£æ—¥å°‡åœ¨è©¦ç”¨æœŸçµæŸçš„éš”æ—¥ï¼ˆUTC+8ï¼‰ã€‚</p>
  </main>

  <script>
    async function postJSON(url, data) {
      return fetch(url, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      }).then(r => r.json());
    }

    async function startSubscribe(period) {
      const userId = window.localStorage.getItem('userId') || 'test-user-' + Date.now();
      window.localStorage.setItem('userId', userId);

      // 1) è¨»å†Šï¼ˆå†ªç­‰ï¼‰
      await postJSON('/api/register', {
        userId,
        displayName: 'WebUser',
        email: '',
        phone: ''
      });

      // 2) å»ºå–®ï¼ˆæœƒè¨ˆç®— 10 æ—¥å…è²»èˆ‡é¦–æ‰£æ—¥ï¼‰
      const r = await postJSON('/api/subscribe', {
        userId,
        displayName: 'WebUser',
        email: '',
        plan: 'pro',
        period // 'month' | 'year'
      });

      if (!r || !r.order_no) {
        alert('å»ºå–®å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦');
        return;
      }

      // 3) äº¤çµ¦å¾Œç«¯ç”¢ç”Ÿ NDNP è¡¨å–®ä¸¦è‡ªå‹•é€å‡º
      location.href = `/pay?order_no=${r.order_no}`;
    }

    document.getElementById('btnMonth').addEventListener('click', () => startSubscribe('month'));
    document.getElementById('btnYear').addEventListener('click', () => startSubscribe('year'));
  </script>
</body>
</html>
